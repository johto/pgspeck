CREATE EXTENSION pgspeck;
-- test vector from the original whitepaper
select to_hex(pgspeck_encrypt32((x'6574694c')::int8, (x'1918111009080100')::int8));
  to_hex  
----------
 a86842f2
(1 row)

select u.val, k.key, pgspeck_decrypt32(pgspeck_encrypt32(u.val, k.key), k.key)
from
unnest(array[
 -- edge values
 0, 1, 4294967294, 4294967295,
 -- a randomly generated set of values
 340411100,3648991854,3883173854,2911300352,170217392,3281780748,2743510608,2227816056,4223735584,1560485918,
 3927159578,3284820474,1333891060,598245358,2408391506,2297414002,2228884466,1475149318,990315928,1065154076,
 4010714368,60823918,2570889252,816192832,3693574190,4127177550,2057598664,941954836,3111942606,3694457644,
 3392854510,4199690084,1837942636,3844069376,3854292914,70869752,3595719730,2272830742,1110902212,1059850778,
 3495696238,743094494,49703956,534620002,1341339854,2458095464,2832034006,3570224320,3933244782,382234993
]) u(val)
cross join (values
	(int8 '0'),
	('1'),
	('7371941163172890000'),
	('1589783502606012418'),
	('9223372036854775807'),
	('-9223372036854775808')
) k(key);
    val     |         key          | pgspeck_decrypt32 
------------+----------------------+-------------------
          0 |                    0 |                 0
          0 |                    1 |                 0
          0 |  7371941163172890000 |                 0
          0 |  1589783502606012418 |                 0
          0 |  9223372036854775807 |                 0
          0 | -9223372036854775808 |                 0
          1 |                    0 |                 1
          1 |                    1 |                 1
          1 |  7371941163172890000 |                 1
          1 |  1589783502606012418 |                 1
          1 |  9223372036854775807 |                 1
          1 | -9223372036854775808 |                 1
 4294967294 |                    0 |        4294967294
 4294967294 |                    1 |        4294967294
 4294967294 |  7371941163172890000 |        4294967294
 4294967294 |  1589783502606012418 |        4294967294
 4294967294 |  9223372036854775807 |        4294967294
 4294967294 | -9223372036854775808 |        4294967294
 4294967295 |                    0 |        4294967295
 4294967295 |                    1 |        4294967295
 4294967295 |  7371941163172890000 |        4294967295
 4294967295 |  1589783502606012418 |        4294967295
 4294967295 |  9223372036854775807 |        4294967295
 4294967295 | -9223372036854775808 |        4294967295
  340411100 |                    0 |         340411100
  340411100 |                    1 |         340411100
  340411100 |  7371941163172890000 |         340411100
  340411100 |  1589783502606012418 |         340411100
  340411100 |  9223372036854775807 |         340411100
  340411100 | -9223372036854775808 |         340411100
 3648991854 |                    0 |        3648991854
 3648991854 |                    1 |        3648991854
 3648991854 |  7371941163172890000 |        3648991854
 3648991854 |  1589783502606012418 |        3648991854
 3648991854 |  9223372036854775807 |        3648991854
 3648991854 | -9223372036854775808 |        3648991854
 3883173854 |                    0 |        3883173854
 3883173854 |                    1 |        3883173854
 3883173854 |  7371941163172890000 |        3883173854
 3883173854 |  1589783502606012418 |        3883173854
 3883173854 |  9223372036854775807 |        3883173854
 3883173854 | -9223372036854775808 |        3883173854
 2911300352 |                    0 |        2911300352
 2911300352 |                    1 |        2911300352
 2911300352 |  7371941163172890000 |        2911300352
 2911300352 |  1589783502606012418 |        2911300352
 2911300352 |  9223372036854775807 |        2911300352
 2911300352 | -9223372036854775808 |        2911300352
  170217392 |                    0 |         170217392
  170217392 |                    1 |         170217392
  170217392 |  7371941163172890000 |         170217392
  170217392 |  1589783502606012418 |         170217392
  170217392 |  9223372036854775807 |         170217392
  170217392 | -9223372036854775808 |         170217392
 3281780748 |                    0 |        3281780748
 3281780748 |                    1 |        3281780748
 3281780748 |  7371941163172890000 |        3281780748
 3281780748 |  1589783502606012418 |        3281780748
 3281780748 |  9223372036854775807 |        3281780748
 3281780748 | -9223372036854775808 |        3281780748
 2743510608 |                    0 |        2743510608
 2743510608 |                    1 |        2743510608
 2743510608 |  7371941163172890000 |        2743510608
 2743510608 |  1589783502606012418 |        2743510608
 2743510608 |  9223372036854775807 |        2743510608
 2743510608 | -9223372036854775808 |        2743510608
 2227816056 |                    0 |        2227816056
 2227816056 |                    1 |        2227816056
 2227816056 |  7371941163172890000 |        2227816056
 2227816056 |  1589783502606012418 |        2227816056
 2227816056 |  9223372036854775807 |        2227816056
 2227816056 | -9223372036854775808 |        2227816056
 4223735584 |                    0 |        4223735584
 4223735584 |                    1 |        4223735584
 4223735584 |  7371941163172890000 |        4223735584
 4223735584 |  1589783502606012418 |        4223735584
 4223735584 |  9223372036854775807 |        4223735584
 4223735584 | -9223372036854775808 |        4223735584
 1560485918 |                    0 |        1560485918
 1560485918 |                    1 |        1560485918
 1560485918 |  7371941163172890000 |        1560485918
 1560485918 |  1589783502606012418 |        1560485918
 1560485918 |  9223372036854775807 |        1560485918
 1560485918 | -9223372036854775808 |        1560485918
 3927159578 |                    0 |        3927159578
 3927159578 |                    1 |        3927159578
 3927159578 |  7371941163172890000 |        3927159578
 3927159578 |  1589783502606012418 |        3927159578
 3927159578 |  9223372036854775807 |        3927159578
 3927159578 | -9223372036854775808 |        3927159578
 3284820474 |                    0 |        3284820474
 3284820474 |                    1 |        3284820474
 3284820474 |  7371941163172890000 |        3284820474
 3284820474 |  1589783502606012418 |        3284820474
 3284820474 |  9223372036854775807 |        3284820474
 3284820474 | -9223372036854775808 |        3284820474
 1333891060 |                    0 |        1333891060
 1333891060 |                    1 |        1333891060
 1333891060 |  7371941163172890000 |        1333891060
 1333891060 |  1589783502606012418 |        1333891060
 1333891060 |  9223372036854775807 |        1333891060
 1333891060 | -9223372036854775808 |        1333891060
  598245358 |                    0 |         598245358
  598245358 |                    1 |         598245358
  598245358 |  7371941163172890000 |         598245358
  598245358 |  1589783502606012418 |         598245358
  598245358 |  9223372036854775807 |         598245358
  598245358 | -9223372036854775808 |         598245358
 2408391506 |                    0 |        2408391506
 2408391506 |                    1 |        2408391506
 2408391506 |  7371941163172890000 |        2408391506
 2408391506 |  1589783502606012418 |        2408391506
 2408391506 |  9223372036854775807 |        2408391506
 2408391506 | -9223372036854775808 |        2408391506
 2297414002 |                    0 |        2297414002
 2297414002 |                    1 |        2297414002
 2297414002 |  7371941163172890000 |        2297414002
 2297414002 |  1589783502606012418 |        2297414002
 2297414002 |  9223372036854775807 |        2297414002
 2297414002 | -9223372036854775808 |        2297414002
 2228884466 |                    0 |        2228884466
 2228884466 |                    1 |        2228884466
 2228884466 |  7371941163172890000 |        2228884466
 2228884466 |  1589783502606012418 |        2228884466
 2228884466 |  9223372036854775807 |        2228884466
 2228884466 | -9223372036854775808 |        2228884466
 1475149318 |                    0 |        1475149318
 1475149318 |                    1 |        1475149318
 1475149318 |  7371941163172890000 |        1475149318
 1475149318 |  1589783502606012418 |        1475149318
 1475149318 |  9223372036854775807 |        1475149318
 1475149318 | -9223372036854775808 |        1475149318
  990315928 |                    0 |         990315928
  990315928 |                    1 |         990315928
  990315928 |  7371941163172890000 |         990315928
  990315928 |  1589783502606012418 |         990315928
  990315928 |  9223372036854775807 |         990315928
  990315928 | -9223372036854775808 |         990315928
 1065154076 |                    0 |        1065154076
 1065154076 |                    1 |        1065154076
 1065154076 |  7371941163172890000 |        1065154076
 1065154076 |  1589783502606012418 |        1065154076
 1065154076 |  9223372036854775807 |        1065154076
 1065154076 | -9223372036854775808 |        1065154076
 4010714368 |                    0 |        4010714368
 4010714368 |                    1 |        4010714368
 4010714368 |  7371941163172890000 |        4010714368
 4010714368 |  1589783502606012418 |        4010714368
 4010714368 |  9223372036854775807 |        4010714368
 4010714368 | -9223372036854775808 |        4010714368
   60823918 |                    0 |          60823918
   60823918 |                    1 |          60823918
   60823918 |  7371941163172890000 |          60823918
   60823918 |  1589783502606012418 |          60823918
   60823918 |  9223372036854775807 |          60823918
   60823918 | -9223372036854775808 |          60823918
 2570889252 |                    0 |        2570889252
 2570889252 |                    1 |        2570889252
 2570889252 |  7371941163172890000 |        2570889252
 2570889252 |  1589783502606012418 |        2570889252
 2570889252 |  9223372036854775807 |        2570889252
 2570889252 | -9223372036854775808 |        2570889252
  816192832 |                    0 |         816192832
  816192832 |                    1 |         816192832
  816192832 |  7371941163172890000 |         816192832
  816192832 |  1589783502606012418 |         816192832
  816192832 |  9223372036854775807 |         816192832
  816192832 | -9223372036854775808 |         816192832
 3693574190 |                    0 |        3693574190
 3693574190 |                    1 |        3693574190
 3693574190 |  7371941163172890000 |        3693574190
 3693574190 |  1589783502606012418 |        3693574190
 3693574190 |  9223372036854775807 |        3693574190
 3693574190 | -9223372036854775808 |        3693574190
 4127177550 |                    0 |        4127177550
 4127177550 |                    1 |        4127177550
 4127177550 |  7371941163172890000 |        4127177550
 4127177550 |  1589783502606012418 |        4127177550
 4127177550 |  9223372036854775807 |        4127177550
 4127177550 | -9223372036854775808 |        4127177550
 2057598664 |                    0 |        2057598664
 2057598664 |                    1 |        2057598664
 2057598664 |  7371941163172890000 |        2057598664
 2057598664 |  1589783502606012418 |        2057598664
 2057598664 |  9223372036854775807 |        2057598664
 2057598664 | -9223372036854775808 |        2057598664
  941954836 |                    0 |         941954836
  941954836 |                    1 |         941954836
  941954836 |  7371941163172890000 |         941954836
  941954836 |  1589783502606012418 |         941954836
  941954836 |  9223372036854775807 |         941954836
  941954836 | -9223372036854775808 |         941954836
 3111942606 |                    0 |        3111942606
 3111942606 |                    1 |        3111942606
 3111942606 |  7371941163172890000 |        3111942606
 3111942606 |  1589783502606012418 |        3111942606
 3111942606 |  9223372036854775807 |        3111942606
 3111942606 | -9223372036854775808 |        3111942606
 3694457644 |                    0 |        3694457644
 3694457644 |                    1 |        3694457644
 3694457644 |  7371941163172890000 |        3694457644
 3694457644 |  1589783502606012418 |        3694457644
 3694457644 |  9223372036854775807 |        3694457644
 3694457644 | -9223372036854775808 |        3694457644
 3392854510 |                    0 |        3392854510
 3392854510 |                    1 |        3392854510
 3392854510 |  7371941163172890000 |        3392854510
 3392854510 |  1589783502606012418 |        3392854510
 3392854510 |  9223372036854775807 |        3392854510
 3392854510 | -9223372036854775808 |        3392854510
 4199690084 |                    0 |        4199690084
 4199690084 |                    1 |        4199690084
 4199690084 |  7371941163172890000 |        4199690084
 4199690084 |  1589783502606012418 |        4199690084
 4199690084 |  9223372036854775807 |        4199690084
 4199690084 | -9223372036854775808 |        4199690084
 1837942636 |                    0 |        1837942636
 1837942636 |                    1 |        1837942636
 1837942636 |  7371941163172890000 |        1837942636
 1837942636 |  1589783502606012418 |        1837942636
 1837942636 |  9223372036854775807 |        1837942636
 1837942636 | -9223372036854775808 |        1837942636
 3844069376 |                    0 |        3844069376
 3844069376 |                    1 |        3844069376
 3844069376 |  7371941163172890000 |        3844069376
 3844069376 |  1589783502606012418 |        3844069376
 3844069376 |  9223372036854775807 |        3844069376
 3844069376 | -9223372036854775808 |        3844069376
 3854292914 |                    0 |        3854292914
 3854292914 |                    1 |        3854292914
 3854292914 |  7371941163172890000 |        3854292914
 3854292914 |  1589783502606012418 |        3854292914
 3854292914 |  9223372036854775807 |        3854292914
 3854292914 | -9223372036854775808 |        3854292914
   70869752 |                    0 |          70869752
   70869752 |                    1 |          70869752
   70869752 |  7371941163172890000 |          70869752
   70869752 |  1589783502606012418 |          70869752
   70869752 |  9223372036854775807 |          70869752
   70869752 | -9223372036854775808 |          70869752
 3595719730 |                    0 |        3595719730
 3595719730 |                    1 |        3595719730
 3595719730 |  7371941163172890000 |        3595719730
 3595719730 |  1589783502606012418 |        3595719730
 3595719730 |  9223372036854775807 |        3595719730
 3595719730 | -9223372036854775808 |        3595719730
 2272830742 |                    0 |        2272830742
 2272830742 |                    1 |        2272830742
 2272830742 |  7371941163172890000 |        2272830742
 2272830742 |  1589783502606012418 |        2272830742
 2272830742 |  9223372036854775807 |        2272830742
 2272830742 | -9223372036854775808 |        2272830742
 1110902212 |                    0 |        1110902212
 1110902212 |                    1 |        1110902212
 1110902212 |  7371941163172890000 |        1110902212
 1110902212 |  1589783502606012418 |        1110902212
 1110902212 |  9223372036854775807 |        1110902212
 1110902212 | -9223372036854775808 |        1110902212
 1059850778 |                    0 |        1059850778
 1059850778 |                    1 |        1059850778
 1059850778 |  7371941163172890000 |        1059850778
 1059850778 |  1589783502606012418 |        1059850778
 1059850778 |  9223372036854775807 |        1059850778
 1059850778 | -9223372036854775808 |        1059850778
 3495696238 |                    0 |        3495696238
 3495696238 |                    1 |        3495696238
 3495696238 |  7371941163172890000 |        3495696238
 3495696238 |  1589783502606012418 |        3495696238
 3495696238 |  9223372036854775807 |        3495696238
 3495696238 | -9223372036854775808 |        3495696238
  743094494 |                    0 |         743094494
  743094494 |                    1 |         743094494
  743094494 |  7371941163172890000 |         743094494
  743094494 |  1589783502606012418 |         743094494
  743094494 |  9223372036854775807 |         743094494
  743094494 | -9223372036854775808 |         743094494
   49703956 |                    0 |          49703956
   49703956 |                    1 |          49703956
   49703956 |  7371941163172890000 |          49703956
   49703956 |  1589783502606012418 |          49703956
   49703956 |  9223372036854775807 |          49703956
   49703956 | -9223372036854775808 |          49703956
  534620002 |                    0 |         534620002
  534620002 |                    1 |         534620002
  534620002 |  7371941163172890000 |         534620002
  534620002 |  1589783502606012418 |         534620002
  534620002 |  9223372036854775807 |         534620002
  534620002 | -9223372036854775808 |         534620002
 1341339854 |                    0 |        1341339854
 1341339854 |                    1 |        1341339854
 1341339854 |  7371941163172890000 |        1341339854
 1341339854 |  1589783502606012418 |        1341339854
 1341339854 |  9223372036854775807 |        1341339854
 1341339854 | -9223372036854775808 |        1341339854
 2458095464 |                    0 |        2458095464
 2458095464 |                    1 |        2458095464
 2458095464 |  7371941163172890000 |        2458095464
 2458095464 |  1589783502606012418 |        2458095464
 2458095464 |  9223372036854775807 |        2458095464
 2458095464 | -9223372036854775808 |        2458095464
 2832034006 |                    0 |        2832034006
 2832034006 |                    1 |        2832034006
 2832034006 |  7371941163172890000 |        2832034006
 2832034006 |  1589783502606012418 |        2832034006
 2832034006 |  9223372036854775807 |        2832034006
 2832034006 | -9223372036854775808 |        2832034006
 3570224320 |                    0 |        3570224320
 3570224320 |                    1 |        3570224320
 3570224320 |  7371941163172890000 |        3570224320
 3570224320 |  1589783502606012418 |        3570224320
 3570224320 |  9223372036854775807 |        3570224320
 3570224320 | -9223372036854775808 |        3570224320
 3933244782 |                    0 |        3933244782
 3933244782 |                    1 |        3933244782
 3933244782 |  7371941163172890000 |        3933244782
 3933244782 |  1589783502606012418 |        3933244782
 3933244782 |  9223372036854775807 |        3933244782
 3933244782 | -9223372036854775808 |        3933244782
  382234993 |                    0 |         382234993
  382234993 |                    1 |         382234993
  382234993 |  7371941163172890000 |         382234993
  382234993 |  1589783502606012418 |         382234993
  382234993 |  9223372036854775807 |         382234993
  382234993 | -9223372036854775808 |         382234993
(324 rows)

-- test vector from the original whitepaper
select to_hex(pgspeck_encrypt48((x'6d2073696874')::int8, (x'1a1918121110')::int8, (x'0a0908020100')::int8));
    to_hex    
--------------
 735e10b6445d
(1 row)

select
	u.val,
	k.key1,
	k.key2,
	pgspeck_encrypt48(u.val, k.key1, k.key2) as encrypted,
	pgspeck_decrypt48(pgspeck_encrypt48(u.val, k.key1, k.key2), k.key1, k.key2) as decrypted
from unnest(array[
	-- edge values
	0, 1, 281474976710654, 281474976710655,
	-- a randomly generated set of values
	340411100,3648991854,3883173854,2911300352,170217392,3281780748,2743510608,2227816056,4223735584,1560485918,
	3927159578,3284820474,1333891060,598245358,2408391506,2297414002,2228884466,1475149318,990315928,1065154076,
	4010714368,60823918,2570889252,816192832,3693574190,4127177550,2057598664,941954836,3111942606,3694457644,
	3392854510,4199690084,1837942636,3844069376,3854292914,70869752,3595719730,2272830742,1110902212,1059850778,
	3495696238,743094494,49703956,534620002,1341339854,2458095464,2832034006,3570224320,3933244782,382234993
]) u(val)
cross join (values
	(int8 '0', int8 '0'),
	('0', '1'),
	('1', '0'),
	('737194116','3172890000'),
	('158978350','2606012418'),
	('922337203','6854775807'),
	('281474976710655','281474976710655')
) k(key1, key2);
       val       |      key1       |      key2       |    encrypted    |    decrypted    
-----------------+-----------------+-----------------+-----------------+-----------------
               0 |               0 |               0 | 121711999573338 |               0
               0 |               0 |               1 |   5406986915626 |               0
               0 |               1 |               0 | 104983315009096 |               0
               0 |       737194116 |      3172890000 | 108110563493413 |               0
               0 |       158978350 |      2606012418 | 180668456260826 |               0
               0 |       922337203 |      6854775807 | 144177203719706 |               0
               0 | 281474976710655 | 281474976710655 | 213818295527426 |               0
               1 |               0 |               0 | 239897411292611 |               1
               1 |               0 |               1 | 118255268099241 |               1
               1 |               1 |               0 | 195731699586635 |               1
               1 |       737194116 |      3172890000 |  30383992866932 |               1
               1 |       158978350 |      2606012418 |  65032048465103 |               1
               1 |       922337203 |      6854775807 |  64795149645748 |               1
               1 | 281474976710655 | 281474976710655 |  41527957563719 |               1
 281474976710654 |               0 |               0 |  63188370147634 | 281474976710654
 281474976710654 |               0 |               1 |  91336293190574 | 281474976710654
 281474976710654 |               1 |               0 |  40824212280235 | 281474976710654
 281474976710654 |       737194116 |      3172890000 |   5940276249568 | 281474976710654
 281474976710654 |       158978350 |      2606012418 |   2814556112851 | 281474976710654
 281474976710654 |       922337203 |      6854775807 | 237300490546601 | 281474976710654
 281474976710654 | 281474976710655 | 281474976710655 | 181726394735260 | 281474976710654
 281474976710655 |               0 |               0 | 124919345232150 | 281474976710655
 281474976710655 |               0 |               1 |  45200822208682 | 281474976710655
 281474976710655 |               1 |               0 | 276572841885274 | 281474976710655
 281474976710655 |       737194116 |      3172890000 | 126498867393087 | 281474976710655
 281474976710655 |       158978350 |      2606012418 | 180239615547955 | 281474976710655
 281474976710655 |       922337203 |      6854775807 | 176498558859717 | 281474976710655
 281474976710655 | 281474976710655 | 281474976710655 |   5110908379991 | 281474976710655
       340411100 |               0 |               0 |   4623729696377 |       340411100
       340411100 |               0 |               1 | 279503399943302 |       340411100
       340411100 |               1 |               0 | 203417371512726 |       340411100
       340411100 |       737194116 |      3172890000 | 112807063576494 |       340411100
       340411100 |       158978350 |      2606012418 |  73460394810382 |       340411100
       340411100 |       922337203 |      6854775807 | 241503460422580 |       340411100
       340411100 | 281474976710655 | 281474976710655 | 219448240770662 |       340411100
      3648991854 |               0 |               0 | 240405583894630 |      3648991854
      3648991854 |               0 |               1 | 123192809453217 |      3648991854
      3648991854 |               1 |               0 |  41394889688463 |      3648991854
      3648991854 |       737194116 |      3172890000 |  71387103724414 |      3648991854
      3648991854 |       158978350 |      2606012418 | 166026172175971 |      3648991854
      3648991854 |       922337203 |      6854775807 | 176011728745794 |      3648991854
      3648991854 | 281474976710655 | 281474976710655 |  44255289581304 |      3648991854
      3883173854 |               0 |               0 | 175698090926636 |      3883173854
      3883173854 |               0 |               1 | 137529521989570 |      3883173854
      3883173854 |               1 |               0 | 162113380718028 |      3883173854
      3883173854 |       737194116 |      3172890000 | 119823153957417 |      3883173854
      3883173854 |       158978350 |      2606012418 | 215332703386558 |      3883173854
      3883173854 |       922337203 |      6854775807 | 264078754434711 |      3883173854
      3883173854 | 281474976710655 | 281474976710655 | 227990045626562 |      3883173854
      2911300352 |               0 |               0 |  64878661485208 |      2911300352
      2911300352 |               0 |               1 | 199231367456715 |      2911300352
      2911300352 |               1 |               0 | 167028879830209 |      2911300352
      2911300352 |       737194116 |      3172890000 | 128098138385335 |      2911300352
      2911300352 |       158978350 |      2606012418 | 109652655386653 |      2911300352
      2911300352 |       922337203 |      6854775807 | 122579968417223 |      2911300352
      2911300352 | 281474976710655 | 281474976710655 | 251788793756249 |      2911300352
       170217392 |               0 |               0 | 276013553226808 |       170217392
       170217392 |               0 |               1 |  88601793259091 |       170217392
       170217392 |               1 |               0 |  43707519379317 |       170217392
       170217392 |       737194116 |      3172890000 | 110473863596072 |       170217392
       170217392 |       158978350 |      2606012418 |  56420444939776 |       170217392
       170217392 |       922337203 |      6854775807 |  34663140597014 |       170217392
       170217392 | 281474976710655 | 281474976710655 |  11247961880480 |       170217392
      3281780748 |               0 |               0 | 159191721921402 |      3281780748
      3281780748 |               0 |               1 | 108962301093792 |      3281780748
      3281780748 |               1 |               0 | 182103629990235 |      3281780748
      3281780748 |       737194116 |      3172890000 |   1625977264170 |      3281780748
      3281780748 |       158978350 |      2606012418 |  88581734320753 |      3281780748
      3281780748 |       922337203 |      6854775807 | 176442245036352 |      3281780748
      3281780748 | 281474976710655 | 281474976710655 | 277040402884321 |      3281780748
      2743510608 |               0 |               0 |  42928739446146 |      2743510608
      2743510608 |               0 |               1 | 233230676017052 |      2743510608
      2743510608 |               1 |               0 |  41930636597006 |      2743510608
      2743510608 |       737194116 |      3172890000 | 248195554465214 |      2743510608
      2743510608 |       158978350 |      2606012418 | 110087879288385 |      2743510608
      2743510608 |       922337203 |      6854775807 |  88099976586517 |      2743510608
      2743510608 | 281474976710655 | 281474976710655 | 177290299908255 |      2743510608
      2227816056 |               0 |               0 | 167725630900845 |      2227816056
      2227816056 |               0 |               1 | 213929977084079 |      2227816056
      2227816056 |               1 |               0 |  26946861114118 |      2227816056
      2227816056 |       737194116 |      3172890000 | 195796661827865 |      2227816056
      2227816056 |       158978350 |      2606012418 | 255689877028717 |      2227816056
      2227816056 |       922337203 |      6854775807 | 187370097547911 |      2227816056
      2227816056 | 281474976710655 | 281474976710655 | 269178327853566 |      2227816056
      4223735584 |               0 |               0 | 182243077789230 |      4223735584
      4223735584 |               0 |               1 |  98387852898577 |      4223735584
      4223735584 |               1 |               0 | 244453112913826 |      4223735584
      4223735584 |       737194116 |      3172890000 | 160710688193892 |      4223735584
      4223735584 |       158978350 |      2606012418 | 202174108813814 |      4223735584
      4223735584 |       922337203 |      6854775807 | 174311646282510 |      4223735584
      4223735584 | 281474976710655 | 281474976710655 |  80738785578433 |      4223735584
      1560485918 |               0 |               0 |  54569000618203 |      1560485918
      1560485918 |               0 |               1 |  33701430452684 |      1560485918
      1560485918 |               1 |               0 |  93779100531939 |      1560485918
      1560485918 |       737194116 |      3172890000 | 192297753227712 |      1560485918
      1560485918 |       158978350 |      2606012418 | 159760996833126 |      1560485918
      1560485918 |       922337203 |      6854775807 | 201709460941375 |      1560485918
      1560485918 | 281474976710655 | 281474976710655 |  78237696511764 |      1560485918
      3927159578 |               0 |               0 | 134746035946480 |      3927159578
      3927159578 |               0 |               1 | 124818722067029 |      3927159578
      3927159578 |               1 |               0 |  58807739933472 |      3927159578
      3927159578 |       737194116 |      3172890000 | 249842433884374 |      3927159578
      3927159578 |       158978350 |      2606012418 | 215121762931869 |      3927159578
      3927159578 |       922337203 |      6854775807 | 169927112991503 |      3927159578
      3927159578 | 281474976710655 | 281474976710655 | 145541608727763 |      3927159578
      3284820474 |               0 |               0 |  69401963980521 |      3284820474
      3284820474 |               0 |               1 | 228005204990936 |      3284820474
      3284820474 |               1 |               0 | 102292230343873 |      3284820474
      3284820474 |       737194116 |      3172890000 | 199201912038265 |      3284820474
      3284820474 |       158978350 |      2606012418 | 220773295878944 |      3284820474
      3284820474 |       922337203 |      6854775807 | 105778040867435 |      3284820474
      3284820474 | 281474976710655 | 281474976710655 | 100195822153837 |      3284820474
      1333891060 |               0 |               0 | 236153079877705 |      1333891060
      1333891060 |               0 |               1 |  95144431164866 |      1333891060
      1333891060 |               1 |               0 | 203164616775218 |      1333891060
      1333891060 |       737194116 |      3172890000 | 262466774793308 |      1333891060
      1333891060 |       158978350 |      2606012418 |   7193667930264 |      1333891060
      1333891060 |       922337203 |      6854775807 |  83165968785354 |      1333891060
      1333891060 | 281474976710655 | 281474976710655 | 277745694216980 |      1333891060
       598245358 |               0 |               0 | 243884831285934 |       598245358
       598245358 |               0 |               1 |  29916317443877 |       598245358
       598245358 |               1 |               0 |   5427208405595 |       598245358
       598245358 |       737194116 |      3172890000 |  35394000359324 |       598245358
       598245358 |       158978350 |      2606012418 | 200992893153836 |       598245358
       598245358 |       922337203 |      6854775807 |  79839411085154 |       598245358
       598245358 | 281474976710655 | 281474976710655 |    255289275381 |       598245358
      2408391506 |               0 |               0 | 236808702948406 |      2408391506
      2408391506 |               0 |               1 | 219451443433569 |      2408391506
      2408391506 |               1 |               0 | 239851886695358 |      2408391506
      2408391506 |       737194116 |      3172890000 | 193160900766457 |      2408391506
      2408391506 |       158978350 |      2606012418 | 145829865247028 |      2408391506
      2408391506 |       922337203 |      6854775807 | 241807195938450 |      2408391506
      2408391506 | 281474976710655 | 281474976710655 | 144923240929761 |      2408391506
      2297414002 |               0 |               0 | 233606177731414 |      2297414002
      2297414002 |               0 |               1 | 276725164879413 |      2297414002
      2297414002 |               1 |               0 | 236146998668211 |      2297414002
      2297414002 |       737194116 |      3172890000 | 263418308985507 |      2297414002
      2297414002 |       158978350 |      2606012418 | 100857135136258 |      2297414002
      2297414002 |       922337203 |      6854775807 | 280689868785956 |      2297414002
      2297414002 | 281474976710655 | 281474976710655 |  67708752059247 |      2297414002
      2228884466 |               0 |               0 | 107763871916869 |      2228884466
      2228884466 |               0 |               1 | 223859556895895 |      2228884466
      2228884466 |               1 |               0 |   9243351179557 |      2228884466
      2228884466 |       737194116 |      3172890000 | 123107556281200 |      2228884466
      2228884466 |       158978350 |      2606012418 | 144245733835185 |      2228884466
      2228884466 |       922337203 |      6854775807 | 145460462108774 |      2228884466
      2228884466 | 281474976710655 | 281474976710655 |  73475853769278 |      2228884466
      1475149318 |               0 |               0 | 142472137450424 |      1475149318
      1475149318 |               0 |               1 | 258574853210612 |      1475149318
      1475149318 |               1 |               0 |  76554061489633 |      1475149318
      1475149318 |       737194116 |      3172890000 | 194442266599193 |      1475149318
      1475149318 |       158978350 |      2606012418 |  80925913386018 |      1475149318
      1475149318 |       922337203 |      6854775807 | 123608680529803 |      1475149318
      1475149318 | 281474976710655 | 281474976710655 | 173978791305802 |      1475149318
       990315928 |               0 |               0 |  82704851442455 |       990315928
       990315928 |               0 |               1 | 176103432169962 |       990315928
       990315928 |               1 |               0 |   7481427999964 |       990315928
       990315928 |       737194116 |      3172890000 |   2757877890821 |       990315928
       990315928 |       158978350 |      2606012418 | 249837059064518 |       990315928
       990315928 |       922337203 |      6854775807 |  98368610267962 |       990315928
       990315928 | 281474976710655 | 281474976710655 |  81342788576667 |       990315928
      1065154076 |               0 |               0 | 175487333373003 |      1065154076
      1065154076 |               0 |               1 |  57755801282494 |      1065154076
      1065154076 |               1 |               0 |  72939396499062 |      1065154076
      1065154076 |       737194116 |      3172890000 | 133169577437695 |      1065154076
      1065154076 |       158978350 |      2606012418 | 243800024505857 |      1065154076
      1065154076 |       922337203 |      6854775807 | 220346479110147 |      1065154076
      1065154076 | 281474976710655 | 281474976710655 | 172685932166652 |      1065154076
      4010714368 |               0 |               0 | 187586970294506 |      4010714368
      4010714368 |               0 |               1 |  73772020200247 |      4010714368
      4010714368 |               1 |               0 | 182850696423688 |      4010714368
      4010714368 |       737194116 |      3172890000 | 112789545204060 |      4010714368
      4010714368 |       158978350 |      2606012418 |  46161047936903 |      4010714368
      4010714368 |       922337203 |      6854775807 | 181262497170797 |      4010714368
      4010714368 | 281474976710655 | 281474976710655 | 105910601508175 |      4010714368
        60823918 |               0 |               0 | 275763173309227 |        60823918
        60823918 |               0 |               1 |  12657225745782 |        60823918
        60823918 |               1 |               0 |  40719117811280 |        60823918
        60823918 |       737194116 |      3172890000 |  28180663369482 |        60823918
        60823918 |       158978350 |      2606012418 |  83802197779174 |        60823918
        60823918 |       922337203 |      6854775807 |  48377191304799 |        60823918
        60823918 | 281474976710655 | 281474976710655 | 119057285505373 |        60823918
      2570889252 |               0 |               0 | 259874225531410 |      2570889252
      2570889252 |               0 |               1 | 255024073306256 |      2570889252
      2570889252 |               1 |               0 | 187633441366889 |      2570889252
      2570889252 |       737194116 |      3172890000 | 262668308723368 |      2570889252
      2570889252 |       158978350 |      2606012418 | 192620873901237 |      2570889252
      2570889252 |       922337203 |      6854775807 | 178714629465836 |      2570889252
      2570889252 | 281474976710655 | 281474976710655 |   9036858030099 |      2570889252
       816192832 |               0 |               0 |  77062582662664 |       816192832
       816192832 |               0 |               1 |  52766256559919 |       816192832
       816192832 |               1 |               0 | 269381514993985 |       816192832
       816192832 |       737194116 |      3172890000 | 165295099828790 |       816192832
       816192832 |       158978350 |      2606012418 | 135996300059154 |       816192832
       816192832 |       922337203 |      6854775807 |  20259812737189 |       816192832
       816192832 | 281474976710655 | 281474976710655 |  17489512131241 |       816192832
      3693574190 |               0 |               0 |  31820206962749 |      3693574190
      3693574190 |               0 |               1 | 159715863955786 |      3693574190
      3693574190 |               1 |               0 |  67227027614736 |      3693574190
      3693574190 |       737194116 |      3172890000 |  56235752997260 |      3693574190
      3693574190 |       158978350 |      2606012418 | 251701370008014 |      3693574190
      3693574190 |       922337203 |      6854775807 | 185634528180910 |      3693574190
      3693574190 | 281474976710655 | 281474976710655 |  92998939670261 |      3693574190
      4127177550 |               0 |               0 | 132782098417064 |      4127177550
      4127177550 |               0 |               1 | 146421838243344 |      4127177550
      4127177550 |               1 |               0 | 203564499005283 |      4127177550
      4127177550 |       737194116 |      3172890000 |  65850244064002 |      4127177550
      4127177550 |       158978350 |      2606012418 | 199792901908832 |      4127177550
      4127177550 |       922337203 |      6854775807 | 180396795442256 |      4127177550
      4127177550 | 281474976710655 | 281474976710655 | 188976300896344 |      4127177550
      2057598664 |               0 |               0 |  77510026638398 |      2057598664
      2057598664 |               0 |               1 | 137721930890604 |      2057598664
      2057598664 |               1 |               0 | 242511330505290 |      2057598664
      2057598664 |       737194116 |      3172890000 | 212899582219601 |      2057598664
      2057598664 |       158978350 |      2606012418 | 277028805050902 |      2057598664
      2057598664 |       922337203 |      6854775807 |  90681837663913 |      2057598664
      2057598664 | 281474976710655 | 281474976710655 | 278537323301885 |      2057598664
       941954836 |               0 |               0 | 180245383609230 |       941954836
       941954836 |               0 |               1 | 120395557452646 |       941954836
       941954836 |               1 |               0 |  87473098318432 |       941954836
       941954836 |       737194116 |      3172890000 |  49062449429823 |       941954836
       941954836 |       158978350 |      2606012418 |  12340081500203 |       941954836
       941954836 |       922337203 |      6854775807 | 116870180818572 |       941954836
       941954836 | 281474976710655 | 281474976710655 | 106246845195425 |       941954836
      3111942606 |               0 |               0 |   1122927328434 |      3111942606
      3111942606 |               0 |               1 |  25240699170334 |      3111942606
      3111942606 |               1 |               0 | 218191034186770 |      3111942606
      3111942606 |       737194116 |      3172890000 |  14376833035597 |      3111942606
      3111942606 |       158978350 |      2606012418 |   6331288267976 |      3111942606
      3111942606 |       922337203 |      6854775807 |  88088703731298 |      3111942606
      3111942606 | 281474976710655 | 281474976710655 | 257376819344895 |      3111942606
      3694457644 |               0 |               0 | 226049933904732 |      3694457644
      3694457644 |               0 |               1 | 238578301578770 |      3694457644
      3694457644 |               1 |               0 | 146574457073215 |      3694457644
      3694457644 |       737194116 |      3172890000 |  61603852089165 |      3694457644
      3694457644 |       158978350 |      2606012418 |  62535770342283 |      3694457644
      3694457644 |       922337203 |      6854775807 | 203217865295021 |      3694457644
      3694457644 | 281474976710655 | 281474976710655 | 225960326818924 |      3694457644
      3392854510 |               0 |               0 | 219525429908930 |      3392854510
      3392854510 |               0 |               1 | 162651890794108 |      3392854510
      3392854510 |               1 |               0 |  73057532033927 |      3392854510
      3392854510 |       737194116 |      3172890000 | 183094492509212 |      3392854510
      3392854510 |       158978350 |      2606012418 |  77258777453748 |      3392854510
      3392854510 |       922337203 |      6854775807 |  98540394329238 |      3392854510
      3392854510 | 281474976710655 | 281474976710655 |  15679965033200 |      3392854510
      4199690084 |               0 |               0 | 180566098787794 |      4199690084
      4199690084 |               0 |               1 |  62305896038423 |      4199690084
      4199690084 |               1 |               0 | 109203570414360 |      4199690084
      4199690084 |       737194116 |      3172890000 | 253657830116631 |      4199690084
      4199690084 |       158978350 |      2606012418 | 170970440831383 |      4199690084
      4199690084 |       922337203 |      6854775807 | 171042694215156 |      4199690084
      4199690084 | 281474976710655 | 281474976710655 |  25046232890821 |      4199690084
      1837942636 |               0 |               0 |  83159005926048 |      1837942636
      1837942636 |               0 |               1 |  34449855004926 |      1837942636
      1837942636 |               1 |               0 | 266217666836266 |      1837942636
      1837942636 |       737194116 |      3172890000 |  40821292899162 |      1837942636
      1837942636 |       158978350 |      2606012418 |  64240262164041 |      1837942636
      1837942636 |       922337203 |      6854775807 | 188091371602463 |      1837942636
      1837942636 | 281474976710655 | 281474976710655 | 122202618262175 |      1837942636
      3844069376 |               0 |               0 |  83507233107415 |      3844069376
      3844069376 |               0 |               1 | 133285072305190 |      3844069376
      3844069376 |               1 |               0 | 122974826927142 |      3844069376
      3844069376 |       737194116 |      3172890000 | 246062674214343 |      3844069376
      3844069376 |       158978350 |      2606012418 | 194942264533788 |      3844069376
      3844069376 |       922337203 |      6854775807 | 246967291893617 |      3844069376
      3844069376 | 281474976710655 | 281474976710655 | 196468423857187 |      3844069376
      3854292914 |               0 |               0 |  49318460321175 |      3854292914
      3854292914 |               0 |               1 |  77443074427131 |      3854292914
      3854292914 |               1 |               0 |  34438751850549 |      3854292914
      3854292914 |       737194116 |      3172890000 |  64540951656335 |      3854292914
      3854292914 |       158978350 |      2606012418 | 118112392765305 |      3854292914
      3854292914 |       922337203 |      6854775807 | 132326273191517 |      3854292914
      3854292914 | 281474976710655 | 281474976710655 | 139636332505077 |      3854292914
        70869752 |               0 |               0 | 178566128268943 |        70869752
        70869752 |               0 |               1 | 174798589730917 |        70869752
        70869752 |               1 |               0 |  73799339075978 |        70869752
        70869752 |       737194116 |      3172890000 | 195807849899129 |        70869752
        70869752 |       158978350 |      2606012418 |  60485443698465 |        70869752
        70869752 |       922337203 |      6854775807 | 120156363054963 |        70869752
        70869752 | 281474976710655 | 281474976710655 | 102055390242046 |        70869752
      3595719730 |               0 |               0 | 246408755776979 |      3595719730
      3595719730 |               0 |               1 | 188960171983896 |      3595719730
      3595719730 |               1 |               0 | 103308084909575 |      3595719730
      3595719730 |       737194116 |      3172890000 | 253532550136126 |      3595719730
      3595719730 |       158978350 |      2606012418 |   7253039999357 |      3595719730
      3595719730 |       922337203 |      6854775807 | 135786216511607 |      3595719730
      3595719730 | 281474976710655 | 281474976710655 | 258580727128403 |      3595719730
      2272830742 |               0 |               0 | 201620261563069 |      2272830742
      2272830742 |               0 |               1 | 245625171814259 |      2272830742
      2272830742 |               1 |               0 | 153904476048624 |      2272830742
      2272830742 |       737194116 |      3172890000 | 231714708177854 |      2272830742
      2272830742 |       158978350 |      2606012418 | 157007642188249 |      2272830742
      2272830742 |       922337203 |      6854775807 | 247218826100682 |      2272830742
      2272830742 | 281474976710655 | 281474976710655 | 280688334633909 |      2272830742
      1110902212 |               0 |               0 | 249467989153272 |      1110902212
      1110902212 |               0 |               1 | 234625848734143 |      1110902212
      1110902212 |               1 |               0 | 127107036031428 |      1110902212
      1110902212 |       737194116 |      3172890000 |  78754294352131 |      1110902212
      1110902212 |       158978350 |      2606012418 |  87415531073280 |      1110902212
      1110902212 |       922337203 |      6854775807 | 124691392583800 |      1110902212
      1110902212 | 281474976710655 | 281474976710655 | 168825612865944 |      1110902212
      1059850778 |               0 |               0 |  45824876145875 |      1059850778
      1059850778 |               0 |               1 | 236719237216575 |      1059850778
      1059850778 |               1 |               0 | 233875716403811 |      1059850778
      1059850778 |       737194116 |      3172890000 | 221033580613051 |      1059850778
      1059850778 |       158978350 |      2606012418 | 130322127190190 |      1059850778
      1059850778 |       922337203 |      6854775807 |  29452341012795 |      1059850778
      1059850778 | 281474976710655 | 281474976710655 |   7744393554073 |      1059850778
      3495696238 |               0 |               0 | 192675695542856 |      3495696238
      3495696238 |               0 |               1 | 151600674803880 |      3495696238
      3495696238 |               1 |               0 |  76054961586132 |      3495696238
      3495696238 |       737194116 |      3172890000 | 141600120832647 |      3495696238
      3495696238 |       158978350 |      2606012418 | 243617360113812 |      3495696238
      3495696238 |       922337203 |      6854775807 | 265115080483772 |      3495696238
      3495696238 | 281474976710655 | 281474976710655 | 229717229678568 |      3495696238
       743094494 |               0 |               0 | 252029670632092 |       743094494
       743094494 |               0 |               1 |  34590673342868 |       743094494
       743094494 |               1 |               0 | 201516330706035 |       743094494
       743094494 |       737194116 |      3172890000 | 259413196753012 |       743094494
       743094494 |       158978350 |      2606012418 | 264958310940429 |       743094494
       743094494 |       922337203 |      6854775807 | 206926138784096 |       743094494
       743094494 | 281474976710655 | 281474976710655 | 169083350716053 |       743094494
        49703956 |               0 |               0 |   9866131010162 |        49703956
        49703956 |               0 |               1 | 185566878257115 |        49703956
        49703956 |               1 |               0 | 225080237227570 |        49703956
        49703956 |       737194116 |      3172890000 | 202071636734610 |        49703956
        49703956 |       158978350 |      2606012418 | 222191277211939 |        49703956
        49703956 |       922337203 |      6854775807 | 129860805612060 |        49703956
        49703956 | 281474976710655 | 281474976710655 |   9105777730520 |        49703956
       534620002 |               0 |               0 | 205786041166999 |       534620002
       534620002 |               0 |               1 | 107260343901142 |       534620002
       534620002 |               1 |               0 | 121691191484506 |       534620002
       534620002 |       737194116 |      3172890000 |  98668846530625 |       534620002
       534620002 |       158978350 |      2606012418 | 174891917687123 |       534620002
       534620002 |       922337203 |      6854775807 | 199730440868250 |       534620002
       534620002 | 281474976710655 | 281474976710655 |   2548943746291 |       534620002
      1341339854 |               0 |               0 |  66399964094581 |      1341339854
      1341339854 |               0 |               1 |  33626430029868 |      1341339854
      1341339854 |               1 |               0 | 106885145828212 |      1341339854
      1341339854 |       737194116 |      3172890000 | 239447611741449 |      1341339854
      1341339854 |       158978350 |      2606012418 | 198352118606561 |      1341339854
      1341339854 |       922337203 |      6854775807 | 277505171972499 |      1341339854
      1341339854 | 281474976710655 | 281474976710655 |  40048623248327 |      1341339854
      2458095464 |               0 |               0 | 152490625632388 |      2458095464
      2458095464 |               0 |               1 | 133106769745511 |      2458095464
      2458095464 |               1 |               0 |  28725773902232 |      2458095464
      2458095464 |       737194116 |      3172890000 | 199370214585242 |      2458095464
      2458095464 |       158978350 |      2606012418 | 246576573319546 |      2458095464
      2458095464 |       922337203 |      6854775807 | 146111175989531 |      2458095464
      2458095464 | 281474976710655 | 281474976710655 | 119274158279385 |      2458095464
      2832034006 |               0 |               0 | 129649637994189 |      2832034006
      2832034006 |               0 |               1 |  43902114631537 |      2832034006
      2832034006 |               1 |               0 | 227897041932986 |      2832034006
      2832034006 |       737194116 |      3172890000 | 153033428827312 |      2832034006
      2832034006 |       158978350 |      2606012418 | 201770116037824 |      2832034006
      2832034006 |       922337203 |      6854775807 | 188531394527340 |      2832034006
      2832034006 | 281474976710655 | 281474976710655 |  31731769275852 |      2832034006
      3570224320 |               0 |               0 | 149492136624395 |      3570224320
      3570224320 |               0 |               1 |  53271704123294 |      3570224320
      3570224320 |               1 |               0 |  25801699923345 |      3570224320
      3570224320 |       737194116 |      3172890000 |  27862015704285 |      3570224320
      3570224320 |       158978350 |      2606012418 |  68863958283005 |      3570224320
      3570224320 |       922337203 |      6854775807 |   3127966923176 |      3570224320
      3570224320 | 281474976710655 | 281474976710655 |  56103646234879 |      3570224320
      3933244782 |               0 |               0 |  53824879042988 |      3933244782
      3933244782 |               0 |               1 |  75119571893382 |      3933244782
      3933244782 |               1 |               0 |  43187946375086 |      3933244782
      3933244782 |       737194116 |      3172890000 | 176671640318464 |      3933244782
      3933244782 |       158978350 |      2606012418 | 207513022831161 |      3933244782
      3933244782 |       922337203 |      6854775807 | 243065599199701 |      3933244782
      3933244782 | 281474976710655 | 281474976710655 |  88148722275238 |      3933244782
       382234993 |               0 |               0 | 192224222278504 |       382234993
       382234993 |               0 |               1 | 107732252840499 |       382234993
       382234993 |               1 |               0 | 216476875856813 |       382234993
       382234993 |       737194116 |      3172890000 | 242826693620081 |       382234993
       382234993 |       158978350 |      2606012418 | 167603260367921 |       382234993
       382234993 |       922337203 |      6854775807 | 262372215267789 |       382234993
       382234993 | 281474976710655 | 281474976710655 | 211393673501080 |       382234993
(378 rows)

-- error conditions
select pgspeck_encrypt48(0, -1, 0);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_encrypt48(0, 0, -1);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_encrypt48(0, 9223372036854775807, 0);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_encrypt48(0, 0, 9223372036854775807);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_decrypt48(0, -1, 0);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_decrypt48(0, 0, -1);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_decrypt48(0, 9223372036854775807, 0);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
select pgspeck_decrypt48(0, 0, 9223372036854775807);
ERROR:  only the lowermost 48 bits of key's components can be non-zero
